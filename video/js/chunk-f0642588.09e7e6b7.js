(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f0642588"],{"295b":function(t,i,s){},"510f":function(t,i,s){"use strict";var e=s("295b"),h=s.n(e);h.a},"951d":function(t,i,s){"use strict";s.r(i);var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"bg-2 flex-col vh100 reg"},[s("van-nav-bar",{staticClass:"flex-none bgwh1",attrs:{title:"设置手势密码","left-arrow":"",border:!1},on:{"click-left":function(i){return t.$router.back()}}}),s("div",{staticClass:"flex-auto ova"},[s("div",{staticClass:"gesturePwd"},[s("div",[s("h4",{ref:"gestureTitle",staticClass:"gestureTitle"},[t._v("请绘制手势密码")]),s("canvas",{ref:"canvas",staticStyle:{"background-color":"transparent",display:"inline-block"}})])])])],1)},h=[],a=(s("9269"),s("d502"),s("073b"),{data:function(){return{currentValue:!1,ctx:"",width:0,height:0,devicePixelRatio:0,chooseType:"",r:"",lastPoint:[],arr:[],restPoint:[],pswObj:{step:2},canvas:"",value:!0}},created:function(){"undefined"!==typeof this.value&&(this.currentValue=this.value)},mounted:function(){this.setChooseType(3)},methods:{closePwd:function(){this.currentValue=!1},H5lock:function(t){this.height=t.height,this.width=t.width,this.chooseType=Number(window.localStorage.getItem("chooseType"))||t.chooseType,this.devicePixelRatio=window.devicePixelRatio||1},drawCle:function(t,i){this.ctx.strokeStyle="#fff",this.ctx.lineWidth=0,this.ctx.beginPath(),this.ctx.arc(t,i,this.r/2.5,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fillStyle="#fff",this.ctx.fill()},drawPoint:function(t){for(var i=0;i<this.lastPoint.length;i++)this.ctx.fillStyle=t,this.ctx.beginPath(),this.ctx.arc(this.lastPoint[i].x,this.lastPoint[i].y,this.r/2.5,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},drawStatusPoint:function(t){for(var i=0;i<this.lastPoint.length;i++)this.ctx.strokeStyle=t,this.ctx.beginPath(),this.ctx.arc(this.lastPoint[i].x,this.lastPoint[i].y,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.stroke()},drawLine:function(t,i,s){this.ctx.beginPath(),this.ctx.strokeStyle=t,this.ctx.lineWidth=3,this.ctx.moveTo(this.lastPoint[0].x,this.lastPoint[0].y);for(var e=1;e<this.lastPoint.length;e++)this.ctx.lineTo(this.lastPoint[e].x,this.lastPoint[e].y);this.ctx.lineTo(i.x,i.y),this.ctx.stroke(),this.ctx.closePath()},createCircle:function(){var t=this.chooseType,i=0;this.r=this.ctx.canvas.width/(2+4*t),this.lastPoint=[],this.arr=[],this.restPoint=[];for(var s=this.r,e=0;e<t;e++)for(var h=0;h<t;h++){i++;var a={x:4*h*s+3*s,y:4*e*s+3*s,index:i};this.arr.push(a),this.restPoint.push(a)}this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(e=0;e<this.arr.length;e++)this.drawCle(this.arr[e].x,this.arr[e].y)},getPosition:function(t){var i=t.currentTarget.getBoundingClientRect(),s={x:(t.touches[0].clientX-i.left)*this.devicePixelRatio,y:(t.touches[0].clientY-i.top)*this.devicePixelRatio};return s},update:function(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(var i=0;i<this.arr.length;i++)this.drawCle(this.arr[i].x,this.arr[i].y);this.drawPoint("#b000ba"),this.drawStatusPoint("#b000ba"),this.drawLine("#b000ba",t,this.lastPoint);for(i=0;i<this.restPoint.length;i++)if(Math.abs(t.x-this.restPoint[i].x)<this.r&&Math.abs(t.y-this.restPoint[i].y)<this.r){this.drawPoint(this.restPoint[i].x,this.restPoint[i].y),this.lastPoint.push(this.restPoint[i]),this.restPoint.splice(i,1);break}},checkPass:function(t,i){for(var s="",e="",h=0;h<t.length;h++)s+=t[h].index+t[h].index;for(h=0;h<i.length;h++)e+=i[h].index+i[h].index;return s===e},storePass:function(t){if(1==this.pswObj.step)this.checkPass(this.pswObj.fpassword,t)?(this.pswObj.spassword=t,this.$refs.gestureTitle.innerHTML="密码保存成功",this.drawStatusPoint("#b000ba"),this.drawPoint("#b000ba"),Toast("密码保存成功"),this.$router.back()):(this.$refs.gestureTitle.innerHTML="两次不一致，重新输入",this.drawStatusPoint("red"),this.drawPoint("red"),delete this.pswObj.step);else if(2==this.pswObj.step)if(this.checkPass(this.pswObj.spassword,t)){var i=this.$refs.gestureTitle;i.innerHTML="解锁成功",this.drawStatusPoint("#b000ba"),this.drawPoint("#b000ba"),this.drawLine("#b000ba",this.lastPoint[this.lastPoint.length-1],this.lastPoint),this.closePwd()}else if(t.length<4){this.drawStatusPoint("red"),this.drawPoint("red"),this.drawLine("red",this.lastPoint[this.lastPoint.length-1],this.lastPoint);i=this.$refs.gestureTitle;i.innerHTML="请连接4个点"}else{this.drawStatusPoint("red"),this.drawPoint("red"),this.drawLine("red",this.lastPoint[this.lastPoint.length-1],this.lastPoint);i=this.$refs.gestureTitle;i.innerHTML="密码错误，您还可以输入N次"}else this.pswObj.step=1,this.pswObj.fpassword=t,this.$refs.gestureTitle.innerHTML="再次输入"},makeState:function(){if(2==this.pswObj.step){var t=this.$refs.gestureTitle;t.innerHTML="请解锁"}else this.pswObj.step},setChooseType:function(t){this.chooseType=t,this.init()},updatePassword:function(){window.localStorage.removeItem("passwordxx"),window.localStorage.removeItem("chooseType"),this.pswObj={},this.$refs.gestureTitle.innerHTML="绘制解锁图案",this.reset()},initDom:function(){this.chooseType=Number(window.localStorage.getItem("chooseType"))||3,this.devicePixelRatio=window.devicePixelRatio||1;var t=this.$refs.canvas,i=this.width||320,s=this.height||320;t.style.width=i+"px",t.style.height=s+"px",t.height=s*this.devicePixelRatio,t.width=i*this.devicePixelRatio},init:function(){this.initDom(),this.pswObj={},this.lastPoint=[],this.makeState(),this.touchFlag=!1,this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.createCircle(),this.bindEvent()},reset:function(){this.makeState(),this.createCircle()},bindEvent:function(){var t=this;this.canvas=this.$refs.canvas,this.canvas.addEventListener("touchstart",(function(i){i.preventDefault();for(var s=t.getPosition(i),e=0;e<t.arr.length;e++)if(Math.abs(s.x-t.arr[e].x)<t.r&&Math.abs(s.y-t.arr[e].y)<t.r){t.touchFlag=!0,t.drawPoint(t.arr[e].x,t.arr[e].y),t.lastPoint.push(t.arr[e]),t.restPoint.splice(e,1);break}}),!1),this.canvas.addEventListener("touchmove",(function(i){t.touchFlag&&t.update(t.getPosition(i))}),!1),this.canvas.addEventListener("touchend",(function(i){t.touchFlag&&(t.touchFlag=!1,t.storePass(t.lastPoint),setTimeout((function(){t.reset()}),1e3))}),!1)}}}),n=a,r=(s("510f"),s("4e82")),o=Object(r["a"])(n,e,h,!1,null,"f6e1742a",null);i["default"]=o.exports}}]);
//# sourceMappingURL=chunk-f0642588.09e7e6b7.js.map