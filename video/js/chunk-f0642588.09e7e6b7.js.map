{"version":3,"sources":["webpack:///./src/pages/PersonalCenter/GestureLock.vue?3d4e","webpack:///./src/pages/PersonalCenter/GestureLock.vue?49ad","webpack:///src/pages/PersonalCenter/GestureLock.vue","webpack:///./src/pages/PersonalCenter/GestureLock.vue?efa3","webpack:///./src/pages/PersonalCenter/GestureLock.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","back","ref","_v","staticStyle","staticRenderFns","data","currentValue","ctx","width","height","devicePixelRatio","chooseType","r","lastPoint","arr","restPoint","pswObj","canvas","value","created","mounted","setChooseType","methods","closePwd","H5lock","obj","window","drawCle","strokeStyle","lineWidth","beginPath","arc","x","y","Math","PI","closePath","fillStyle","fill","drawPoint","i","length","style","drawStatusPoint","type","stroke","drawLine","moveTo","lineTo","po","createCircle","n","count","j","index","push","clearRect","getPosition","rect","e","currentTarget","getBoundingClientRect","touches","clientX","left","clientY","top","update","splice","checkPass","p1","psw1","psw2","p2","storePass","step","fpassword","psw","spassword","$refs","gestureTitle","innerHTML","Toast","makeState","init","updatePassword","localStorage","removeItem","reset","initDom","Number","getItem","touchFlag","getContext","bindEvent","self","addEventListener","component"],"mappings":"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","file":"js/chunk-f0642588.09e7e6b7.js","sourcesContent":["import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.8.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.3.2@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.7.2@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!./GestureLock.vue?vue&type=style&index=0&id=f6e1742a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.8.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.3.2@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.7.2@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!./GestureLock.vue?vue&type=style&index=0&id=f6e1742a&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"bg-2 flex-col vh100 reg\"},[_c('van-nav-bar',{staticClass:\"flex-none bgwh1\",attrs:{\"title\":\"设置手势密码\",\"left-arrow\":\"\",\"border\":false},on:{\"click-left\":function($event){return _vm.$router.back()}}}),_c('div',{staticClass:\"flex-auto ova\"},[_c('div',{staticClass:\"gesturePwd\"},[_c('div',[_c('h4',{ref:\"gestureTitle\",staticClass:\"gestureTitle\"},[_vm._v(\"请绘制手势密码\")]),_c('canvas',{ref:\"canvas\",staticStyle:{\"background-color\":\"transparent\",\"display\":\"inline-block\"}})])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"bg-2 flex-col vh100 reg\">\r\n    <van-nav-bar\r\n      class=\"flex-none bgwh1\"\r\n      title=\"设置手势密码\"\r\n      left-arrow\r\n      :border=\"false\"\r\n      @click-left=\"$router.back()\">\r\n    </van-nav-bar>\r\n    <div class=\"flex-auto ova\">\r\n      <div class=\"gesturePwd\">\r\n        <div>\r\n          <h4 ref=\"gestureTitle\" class=\"gestureTitle\">请绘制手势密码</h4>\r\n          <canvas ref=\"canvas\" style=\"background-color:transparent; display: inline-block;\"></canvas>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      currentValue: false,\r\n      ctx: '',\r\n      width: 0,\r\n      height: 0,\r\n      devicePixelRatio: 0,\r\n      chooseType: '',\r\n      r: '', // 公式计算\r\n      lastPoint: [],\r\n      arr: [],\r\n      restPoint: [],\r\n      pswObj: { step: 2 },\r\n      canvas: '',\r\n      value: true,\r\n    };\r\n  },\r\n  created() {\r\n    if (typeof this.value !== 'undefined') {\r\n      this.currentValue = this.value;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.setChooseType(3);\r\n  },\r\n  methods: {\r\n    closePwd() {\r\n      this.currentValue = false;\r\n    },\r\n    H5lock(obj) {\r\n      this.height = obj.height;\r\n      this.width = obj.width;\r\n      this.chooseType =\r\n        Number(window.localStorage.getItem('chooseType')) || obj.chooseType;\r\n      this.devicePixelRatio = window.devicePixelRatio || 1;\r\n    },\r\n    drawCle(x, y) {\r\n      // 初始化解锁密码面板 小圆圈\r\n      this.ctx.strokeStyle = '#fff'; //密码的点点默认的颜色\r\n      this.ctx.lineWidth = 0;\r\n      this.ctx.beginPath();\r\n      this.ctx.arc(x, y, this.r / 2.5, 0, Math.PI * 2, true);\r\n      this.ctx.closePath();\r\n      // this.ctx.stroke();\r\n      this.ctx.fillStyle = '#fff';\r\n      this.ctx.fill();\r\n    },\r\n    drawPoint(style) {\r\n      // 初始化圆心\r\n      for (var i = 0; i < this.lastPoint.length; i++) {\r\n        this.ctx.fillStyle = style;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(\r\n          this.lastPoint[i].x,\r\n          this.lastPoint[i].y,\r\n          this.r / 2.5,\r\n          0,\r\n          Math.PI * 2,\r\n          true\r\n        );\r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n      }\r\n    },\r\n    drawStatusPoint(type) {\r\n      // 初始化状态线条\r\n      for (var i = 0; i < this.lastPoint.length; i++) {\r\n        this.ctx.strokeStyle = type;\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(\r\n          this.lastPoint[i].x,\r\n          this.lastPoint[i].y,\r\n          this.r,\r\n          0,\r\n          Math.PI * 2,\r\n          true\r\n        );\r\n        this.ctx.closePath();\r\n        this.ctx.stroke();\r\n      }\r\n    },\r\n    drawLine(style, po, lastPoint) {\r\n      //style:颜色 解锁轨迹\r\n      this.ctx.beginPath();\r\n      this.ctx.strokeStyle = style;\r\n      this.ctx.lineWidth = 3;\r\n      this.ctx.moveTo(this.lastPoint[0].x, this.lastPoint[0].y);\r\n      for (var i = 1; i < this.lastPoint.length; i++) {\r\n        this.ctx.lineTo(this.lastPoint[i].x, this.lastPoint[i].y);\r\n      }\r\n      this.ctx.lineTo(po.x, po.y);\r\n      this.ctx.stroke();\r\n      this.ctx.closePath();\r\n    },\r\n    createCircle() {\r\n      // 创建解锁点的坐标，根据canvas的大小来平均分配半径\r\n      var n = this.chooseType;\r\n      var count = 0;\r\n      this.r = this.ctx.canvas.width / (2 + 4 * n); // 公式计算\r\n      this.lastPoint = [];\r\n      this.arr = [];\r\n      this.restPoint = [];\r\n      var r = this.r;\r\n      for (var i = 0; i < n; i++) {\r\n        for (var j = 0; j < n; j++) {\r\n          count++;\r\n          var obj = {\r\n            x: j * 4 * r + 3 * r,\r\n            y: i * 4 * r + 3 * r,\r\n            index: count,\r\n          };\r\n          this.arr.push(obj);\r\n          this.restPoint.push(obj);\r\n        }\r\n      }\r\n      this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n      for (var i = 0; i < this.arr.length; i++) {\r\n        this.drawCle(this.arr[i].x, this.arr[i].y);\r\n      }\r\n      //return arr;\r\n    },\r\n    getPosition(e) {\r\n      // 获取touch点相对于canvas的坐标\r\n      var rect = e.currentTarget.getBoundingClientRect();\r\n      var po = {\r\n        x: (e.touches[0].clientX - rect.left) * this.devicePixelRatio,\r\n        y: (e.touches[0].clientY - rect.top) * this.devicePixelRatio,\r\n      };\r\n      return po;\r\n    },\r\n    update(po) {\r\n      // 核心变换方法在touchmove时候调用\r\n      this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n      for (var i = 0; i < this.arr.length; i++) {\r\n        // 每帧先把面板画出来\r\n        this.drawCle(this.arr[i].x, this.arr[i].y);\r\n      }\r\n      this.drawPoint('#b000ba'); // 每帧花轨迹\r\n      this.drawStatusPoint('#b000ba'); // 每帧花轨迹\r\n      this.drawLine('#b000ba', po, this.lastPoint); // 每帧画圆心\r\n      for (var i = 0; i < this.restPoint.length; i++) {\r\n        if (\r\n          Math.abs(po.x - this.restPoint[i].x) < this.r &&\r\n          Math.abs(po.y - this.restPoint[i].y) < this.r\r\n        ) {\r\n          this.drawPoint(this.restPoint[i].x, this.restPoint[i].y);\r\n          this.lastPoint.push(this.restPoint[i]);\r\n          this.restPoint.splice(i, 1);\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    checkPass(psw1, psw2) {\r\n      // 检测密码\r\n      var p1 = '',\r\n        p2 = '';\r\n      for (var i = 0; i < psw1.length; i++) {\r\n        p1 += psw1[i].index + psw1[i].index;\r\n      }\r\n      for (var i = 0; i < psw2.length; i++) {\r\n        p2 += psw2[i].index + psw2[i].index;\r\n      }\r\n      return p1 === p2;\r\n    },\r\n    storePass(psw) {\r\n      // touchend结束之后对密码和状态的处理\r\n      if (this.pswObj.step == 1) {\r\n        if (this.checkPass(this.pswObj.fpassword, psw)) {\r\n          // this.pswObj.step = 2;\r\n          this.pswObj.spassword = psw;\r\n          this.$refs.gestureTitle.innerHTML = '密码保存成功';\r\n          this.drawStatusPoint('#b000ba');\r\n          this.drawPoint('#b000ba');\r\n          Toast('密码保存成功');\r\n          this.$router.back();\r\n          // window.localStorage.setItem(\r\n          //   'passwordxx',\r\n          //   JSON.stringify(this.pswObj.spassword)\r\n          // );\r\n          // window.localStorage.setItem('chooseType', this.chooseType);\r\n        } else {\r\n          this.$refs.gestureTitle.innerHTML = '两次不一致，重新输入';\r\n          this.drawStatusPoint('red');\r\n          this.drawPoint('red');\r\n          delete this.pswObj.step;\r\n        }\r\n      } else if (this.pswObj.step == 2) {\r\n        if (this.checkPass(this.pswObj.spassword, psw)) {\r\n          var gestureTitle = this.$refs.gestureTitle;\r\n          gestureTitle.innerHTML = '解锁成功';\r\n          this.drawStatusPoint('#b000ba'); //小点点外圈高亮\r\n          this.drawPoint('#b000ba');\r\n          this.drawLine(\r\n            '#b000ba',\r\n            this.lastPoint[this.lastPoint.length - 1],\r\n            this.lastPoint\r\n          ); // 每帧画圆心\r\n\r\n          this.closePwd();\r\n        } else if (psw.length < 4) {\r\n          this.drawStatusPoint('red');\r\n          this.drawPoint('red');\r\n          this.drawLine(\r\n            'red',\r\n            this.lastPoint[this.lastPoint.length - 1],\r\n            this.lastPoint\r\n          ); // 每帧画圆心\r\n          var gestureTitle = this.$refs.gestureTitle;\r\n          gestureTitle.innerHTML = '请连接4个点';\r\n        } else {\r\n          this.drawStatusPoint('red');\r\n          this.drawPoint('red');\r\n          this.drawLine(\r\n            'red',\r\n            this.lastPoint[this.lastPoint.length - 1],\r\n            this.lastPoint\r\n          ); // 每帧画圆心\r\n          var gestureTitle = this.$refs.gestureTitle;\r\n          gestureTitle.innerHTML = '密码错误，您还可以输入N次';\r\n        }\r\n      } else {\r\n        this.pswObj.step = 1;\r\n        this.pswObj.fpassword = psw;\r\n        this.$refs.gestureTitle.innerHTML = '再次输入';\r\n      }\r\n    },\r\n    makeState() {\r\n      if (this.pswObj.step == 2) {\r\n        // this.$refs.updatePassword.style.display = 'block';\r\n        var gestureTitle = this.$refs.gestureTitle;\r\n        gestureTitle.innerHTML = '请解锁';\r\n      } else if (this.pswObj.step == 1) {\r\n        // this.$refs.updatePassword.style.display = 'none';\r\n      } else {\r\n        // this.$refs.updatePassword.style.display = 'block';\r\n        // this.$refs.updatePassword.style.display  = 'block';\r\n      }\r\n    },\r\n    setChooseType(type) {\r\n      this.chooseType = type;\r\n      this.init();\r\n    },\r\n    updatePassword() {\r\n      window.localStorage.removeItem('passwordxx');\r\n      window.localStorage.removeItem('chooseType');\r\n      this.pswObj = {};\r\n      this.$refs.gestureTitle.innerHTML = '绘制解锁图案';\r\n      this.reset();\r\n    },\r\n    initDom() {\r\n      this.chooseType = Number(window.localStorage.getItem('chooseType')) || 3;\r\n      this.devicePixelRatio = window.devicePixelRatio || 1;\r\n      var canvas = this.$refs.canvas;\r\n      var width = this.width || 320;\r\n      var height = this.height || 320;\r\n      // 高清屏锁放\r\n      canvas.style.width = width + 'px';\r\n      canvas.style.height = height + 'px';\r\n      canvas.height = height * this.devicePixelRatio;\r\n      canvas.width = width * this.devicePixelRatio;\r\n    },\r\n    init() {\r\n      this.initDom();\r\n      // this.pswObj = window.localStorage.getItem('passwordxx')\r\n      //   ? {\r\n      //       step: 2,\r\n      //       spassword: JSON.parse(window.localStorage.getItem('passwordxx')),\r\n      //     }\r\n      //   : {};\r\n      this.pswObj = {};\r\n      this.lastPoint = [];\r\n      this.makeState();\r\n      this.touchFlag = false;\r\n      this.canvas = this.$refs.canvas;\r\n\r\n      this.ctx = this.canvas.getContext('2d');\r\n      this.createCircle();\r\n      this.bindEvent();\r\n    },\r\n    reset() {\r\n      this.makeState();\r\n      this.createCircle();\r\n    },\r\n    bindEvent() {\r\n      var self = this;\r\n      this.canvas = this.$refs.canvas;\r\n      this.canvas.addEventListener(\r\n        'touchstart',\r\n        function(e) {\r\n          e.preventDefault(); // 某些android 的 touchmove不宜触发 所以增加此行代码\r\n          var po = self.getPosition(e);\r\n          for (var i = 0; i < self.arr.length; i++) {\r\n            if (\r\n              Math.abs(po.x - self.arr[i].x) < self.r &&\r\n              Math.abs(po.y - self.arr[i].y) < self.r\r\n            ) {\r\n              self.touchFlag = true;\r\n              self.drawPoint(self.arr[i].x, self.arr[i].y);\r\n              self.lastPoint.push(self.arr[i]);\r\n              self.restPoint.splice(i, 1);\r\n              break;\r\n            }\r\n          }\r\n        },\r\n        false\r\n      );\r\n      this.canvas.addEventListener(\r\n        'touchmove',\r\n        function(e) {\r\n          if (self.touchFlag) {\r\n            self.update(self.getPosition(e));\r\n          }\r\n        },\r\n        false\r\n      );\r\n      this.canvas.addEventListener(\r\n        'touchend',\r\n        function(e) {\r\n          if (self.touchFlag) {\r\n            self.touchFlag = false;\r\n            self.storePass(self.lastPoint);\r\n            setTimeout(function() {\r\n              self.reset();\r\n            }, 1000);\r\n          }\r\n        },\r\n        false\r\n      );\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.masks {\r\n  text-align: center;\r\n  position: relative;\r\n}\r\n.gesturePwd {\r\n  height: 100%;\r\n  text-align: center;\r\n  overflow: hidden;\r\n}\r\n.gestureTitle {\r\n  color: #fff;\r\n  margin-top: 80px;\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n  font-weight: normal;\r\n}\r\ncanvas {\r\n  width: 320px;\r\n  height: 320px;\r\n  margin-top: 70px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!./GestureLock.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!./GestureLock.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GestureLock.vue?vue&type=template&id=f6e1742a&scoped=true&\"\nimport script from \"./GestureLock.vue?vue&type=script&lang=js&\"\nexport * from \"./GestureLock.vue?vue&type=script&lang=js&\"\nimport style0 from \"./GestureLock.vue?vue&type=style&index=0&id=f6e1742a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.7.2@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f6e1742a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}